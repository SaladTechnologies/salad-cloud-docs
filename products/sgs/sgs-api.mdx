---
title: 'SGS API'
description: 'Optional feature to manage streaming capability tags for nodes in your network'
---

_Last Updated: March 20, 2025_

# The SGS API

The SGS API enables you to manage streaming capability tags for nodes in your network. By tagging nodes based on their
ability to handle specific streaming services, you can create optimized routing paths for different workloads.

> **Important:** The SGS API is only available on some SGS servers. Contact your account manager to enable this feature.

## Parameter Updates

We're introducing a new `&tag=` parameter that replaces the legacy `&cap=` parameter. Both parameters currently function
identically, but we recommend using `&tag=` for future compatibility.

## How Node Selection Works

When you specify a tag, our system selects nodes in this order:

1. Nodes with your requested tag
2. Nodes with internal tags assigned by Salad's DHC system (if no match is found in step 1)
3. Least-loaded node (if no match is found in steps 1 or 2)

## Usage Examples

### URL Parameters

You can request a node with a specific tag by adding the `&tag=` parameter to the end of your session ID:

```
{sessionId}&tag={yourTag}
{sessionId}&cap={yourTag}  (legacy, still supported)
```

### HTTP Headers

Alternatively, you can request a node with a specific tag by adding the `X-Sgs-Tag` header to your request:

```
X-Sgs-Tag: {yourTag}
X-Sgs-Capabilities: {yourTag}  (legacy, still supported)
```

All examples above produce identical routing behavior.

# Tagging Nodes

## Authentication

All API requests require your Salad-provided JWT token:

```bash
curl https://{sgs_name}.salad.com:7443/nodes \
  -H "Authorization: Bearer YOUR_SALAD_JWT"
```

Requests without proper authentication will receive a `401 Unauthorized` response.

## Nodes

### List all nodes

```http
GET /nodes
```

Returns all active, non-quarantined nodes connected to your SGS server.

#### Example response

```json
{
  "nodes": [
    {
      "machine_id": "5ebfa363-6e0b-4db1-b9be-70ed4995d0b1",
      "tags": {
        "nflx": 1,
        "dsnp": 1
      },
      "update_time": "2023-05-04T05:41:05Z"
    }
  ]
}
```

### Retrieve a node

```http
GET /nodes/{machine_id}
```

Retrieves information about a specific node.

#### Example response

```json
{
  "machine_id": "5ebfa363-6e0b-4db1-b9be-70ed4995d0b1",
  "tags": {
    "nflx": 1,
    "dsnp": 1
  },
  "update_time": "2023-05-04T05:41:05Z"
}
```

### Update a node

```http
PATCH /nodes/{machine_id}/tags
```

Updates capability tags for a specific node.

Tag values must be between 0 and 1, where:

- `0` indicates the node cannot handle the service
- Any value `> 0` and `â‰¤ 1` indicates the node can handle the service
  > **Note:** The rational number tag values (between `0` and `1`) enable future weighted load balancing features.

> **Important:** We recommend using a unique prefix (like `internal-`) for your tags to avoid conflicts with Salad's
> existing DHC labels.

#### Parameters

| Parameter      | Description                                                                           |
| -------------- | ------------------------------------------------------------------------------------- |
| `service_name` | Key-value pairs where key is the service name and value is between 0 and 1, inclusive |

#### Example request

```json
{
  "nflx": 1,
  "dsnp": 0,
  "itv": 0.8
}
```

### Remove all tags

```http
DELETE /nodes/{machine_id}/tags
```

Removes all capability tags from a node.

## Routing behavior

- SGS routes sessions for a service only to nodes with a positive tag value (`> 0`) for that service
- Missing tags are treated as `0` (unroutable)
- If all nodes are unroutable for a requested capability, SGS will "fail open" and distribute traffic across all nodes
- The rational number tag values (between `0` and `1`) enable future weighted load balancing features

## Common workflows

### Qualifying nodes for a new service

1. List all nodes to identify machine IDs
2. Test each node for your new service (e.g., "internal-target-service") by targeting specific nodes:
   ```bash
   # Add the X-Sgs-Machine-Id header to test a specific node
   # Do not use &tag= in the sessionID during testing
   curl https://your-streaming-endpoint.example.com \
     -H "X-Sgs-Machine-Id: 5ebfa363-6e0b-4db1-b9be-70ed4995d0b1"
   ```
3. Tag successful nodes:
   ```bash
   curl -X PATCH https://{sgs_name}.salad.com:7443/nodes/{machine_id}/tags \
     -H "Authorization: Bearer YOUR_SALAD_JWT" \
     -H "Content-Type: application/json" \
     -d '{"internal-target-service": 1}'
   ```
4. Route traffic to successful nodes by suffixing `&tag=internal-streaming` to your session ID (e.g.,
   "`https://sessionID1234?cap=internal-target-service:{PASSWORD}@{sgs_name}.salad.com`"), or by adding it as a header
   in your request as follows: "`X-Sgs-Tag`:`internal-target-service`".
